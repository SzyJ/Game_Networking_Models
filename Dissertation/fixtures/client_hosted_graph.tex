\begin{figure}[h]

  \centering
  \begin{sequencediagram}
    \newthread{client}{Client}{}
    \newinst{server-lsn}{Server Listener}{}
    \newinst{key-lsn}{Keyboard Listener}{}
    \newthread{server}{Server}{}

    \begin{sdblock}{Connection - TCP protocol}{}

      \begin{call}{server}{openToClientConnection()}{server}{\textit{Once all clients connect...}}
        \postlevel
        \postlevel
        \postlevel
        \postlevel
      \end{call}

      \prelevel \prelevel \prelevel
      \prelevel \prelevel
      \mess{client}{JR[UDP Port to use]}{server}
      \begin{call}{client}{listenForServerMsg()}{client}{}
        \mess{server}{JA<ID>}{client}
      \end{call}


      \begin{call}{client}{listenForServerMsg()}{client}{}
        \mess{server}{DE[<ID><VAL>...]}{client}
      \end{call}
    \end{sdblock}

    \begin{sdblock}{Update Loop - UDP protocol}{}

      \begin{call}{server}{startUpdateLoop()}{server}{\textit{simulation finished}}
        \postlevel \postlevel \postlevel
        \postlevel \postlevel \postlevel
      \end{call}
      \prelevel \prelevel \prelevel
      \prelevel \prelevel \prelevel


      \begin{call}{client}{startServerListen()}{server-lsn}{\textit{loop}}
        \mess{server}{CS< <ID><VAL> ... >}{server-lsn}
        \postlevel \postlevel \postlevel
      \end{call}

      \prelevel \prelevel \prelevel
      \begin{call}{client}{startKeyboardListen()}{key-lsn}{}
        \mess{key-lsn}{UP<VAL>}{server}
      \end{call}

    \end{sdblock}
  \end{sequencediagram}

  \caption{Graph showing the protocol of joining a session hosted on the server as well as sending and receiving updates.}
  \label{fig:client-protocol}
\end{figure}
